<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>TinyLink â€” Stats</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 p-6">

  <div class="max-w-xl mx-auto bg-white p-6 rounded-xl shadow">

    <h1 class="text-2xl font-bold mb-4 text-center text-purple-700">TinyLink Stats</h1>

    <div id="content" class="text-center text-lg">Loading...</div>
  </div>

<script>
const API = "";

async function loadStats() {
  const parts = window.location.pathname.split("/");
  const code = parts[2];

  const res = await fetch(`/api/links/${code}`);

  if (res.status === 404) {
    content.innerHTML = `<p class="text-red-600">Short link not found!</p>`;
    return;
  }

  const link = await res.json();

  const shortUrl = `${window.location.origin}/${code}`;

  content.innerHTML = `
    <div class="space-y-4">

      <p><strong>Code:</strong> <span class="text-purple-700">${link.code}</span></p>
      <p><strong>Target:</strong> <a href="${link.url}" class="text-purple-700 underline" target="_blank">${link.url}</a></p>
      <p><strong>Total Clicks:</strong> ${link.clicks}</p>
      <p><strong>Last Clicked:</strong> ${link.last_clicked || "-"}</p>

      <button onclick="copyLink('${code}')" 
        class="bg-black text-white w-full py-2 rounded">Copy Link</button>

      <button onclick="deleteLink('${code}')" 
        class="bg-red-600 text-white w-full py-2 rounded">Delete Link</button>

      <a href="/" class="block text-center bg-gray-400 text-white py-2 rounded">Back to Dashboard</a>
    </div>
  `;
}

function copyLink(code) {
  navigator.clipboard.writeText(window.location.origin + "/" + code);
  alert("Copied!");
}

async function deleteLink(code) {
  await fetch(`/api/links/${code}`, { method: "DELETE" });
  window.location.href = "/";
}

loadStats();
</script>

</body>
</html>
